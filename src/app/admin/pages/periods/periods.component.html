<body [ngClass]="darkTheme() ? 'dark-theme flex-center-center-column' : 'flex-center-center-column' ">
    <section class="container flex-center-center-column">
        <h2 class="tittle mb-24"> Periodos </h2>

        <span class="medium mb-24">
            Información detallada de todos los períodos
             registrados en el sistema de calificaciones.
        </span>

        <nav class="mb-24">
            <button class="btn-primary-icon flex-center-center-row" (click)="addPeriod()"> 
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 5v14"></path>
                    <path d="M5 12h14"></path>
                </svg>
                <p class="small">Agregar periodo</p>
            </button>
            <button class="btn-primary-icon flex-center-center-row" (click)="downloadPeriods()" [disabled]="periods.length === 0"> 
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"></path>
                    <path d="m7 11 5 5 5-5"></path>
                    <path d="M12 4v12"></path>
                </svg>
                <p class="small">Descargar periodos</p>
            </button>
        </nav>

        @defer(on timer(3s)){
            @if(periods.length > 0){
                <table class="mb-24">
                    <thead>
                        <th class="small size-small col-1">No</th>
                        <th class="small size-large col-2">Periodo</th>
                        <th class="small size-large col-3">Reticula</th>
                        <th class="small size-large col-4">Fecha</th>
                        <th class="small size-large col-5">Hora</th>
                        <th class="small size-large col-6">Opciones</th>
                    </thead>
            
                    <tbody>
                        @for(period of periods; track $index){
                            <tr>
                                <td class="small size-small col-1">{{(currentPage - 1) * pageSize + $index + 1}}</td>
                                <td class="small size-large col-2">{{period?.periodo}}</td>
                                <td class="small size-large col-3">{{subjects[$index]?.claveReticula}}</td>
                                <td class="small size-large col-4">{{period?.fechaRegistro}}</td>
                                <td class="small size-large col-5">{{period?.horaRegistro}}</td>
                                <td class="small size-large col-6"> 
                                    <button class="btn-delete" (click)="deletePeriod(period._id)"> 
                                        <svg stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M4 7h16"></path>
                                            <path d="M10 11v6"></path>
                                            <path d="M14 11v6"></path>
                                            <path d="m5 7 1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-12"></path>
                                            <path d="M9 7V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3"></path>
                                        </svg>
                                    </button> 
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <div class="flex-center-center-row pagination">
                    <button class="btn-secondary" (click)="previousPage()" [disabled]="currentPage === 1"> ant </button>
                    <div class="pag">
                        @if(currentPage > 2){
                            <button class="btn-secondary" (click)="goToPage(currentPage - 2)"> {{currentPage - 2}} </button>
                        }
                        @if(currentPage > 1){
                            <button class="btn-secondary" (click)="goToPage(currentPage - 1)"> {{currentPage - 1}} </button>
                        }

                        <button class="btn-primary"> {{currentPage}} </button>

                        @if((totalPages - currentPage ) >= 1){
                            <button class="btn-secondary" (click)="goToPage(currentPage + 1)"> {{currentPage+1}} </button>
                        }
                        @if((totalPages - currentPage ) >= 2){
                            <button class="btn-secondary" (click)="goToPage(currentPage + 2)"> {{currentPage+2}} </button>
                        }
                    </div>
                    <button class="btn-secondary" (click)="nextPage()" [disabled]="currentPage === totalPages"> sig </button>
                </div>
            }@else{
                <div class="flex-center-center-column empty">
                    <span class="medium"> Por el momento, aún no hay periodos registrados en el sistema. </span>
                </div>
            }
        }@placeholder{
            <div class="flex-center-center-column loader">
                <span class="spinner mb-24"></span>
                <span class="medium">Cargando información</span>
            </div>
        }

    </section>
</body>